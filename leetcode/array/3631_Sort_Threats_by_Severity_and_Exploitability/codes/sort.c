#include <stdio.h>
#include <stdlib.h>

typedef struct {
    int id;
    long long sev;
    long long exp;
} Threat;

int cmp(const void* p1, const void* p2) {
    Threat* a = (Threat*)p1;
    Threat* b = (Threat*)p2;
    long long scoreA = 2LL * a -> sev + a -> exp;
    long long scoreB = 2LL * b -> sev + b -> exp;
    if (scoreA != scoreB) return (scoreB > scoreA) - (scoreB < scoreA);
    return (a -> id > b -> id) - (a -> id < b -> id);
}

int** sortThreats(int** threats, int threatsSize, int* threatsColSize, int* returnSize, int** returnColumnSizes) {
    Threat* arr = (Threat*)malloc(threatsSize * sizeof(Threat));
    for (int i = 0; i < threatsSize; i++) {
        arr[i].id = threats[i][0];
        arr[i].sev = threats[i][1];
        arr[i].exp = threats[i][2];
    }

    qsort(arr, threatsSize, sizeof(Threat), cmp);

    int** result = (int**)malloc(threatsSize * sizeof(int*));
    *returnColumnSizes = (int*)malloc(threatsSize * sizeof(int));
    for (int i = 0; i < threatsSize; i++) {
        result[i] = (int*)malloc(3 * sizeof(int));
        (*returnColumnSizes)[i] = 3;
        result[i][0] = arr[i].id;
        result[i][1] = (int)arr[i].sev;
        result[i][2] = (int)arr[i].exp;
    }

    free(arr);
    *returnSize = threatsSize;
    return result;
}
